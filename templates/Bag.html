<!DOCTYPE html>
<html>
<head>
    <title>Ürünler</title>
    <style>
        .product-card {
            position: relative;
            width: 300px;
            height: 450px;
            background-color: #f8f8f8;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        .product-card img {
            width: 100%;
            height: 60%;
            object-fit: cover;
            border-radius: 10px 10px 0 0;
            /* Maksimum genişlik ve yükseklik ayarları */
            max-width: 100%;
            max-height: 200px;
        }
        /* Diğer stil kurallarını burada belirleyebilirsiniz */
    </style>

</head>
<body>
    <h1>Ürünleriniz</h1>
    <div id="productList">
        <!-- Burada ürün kartlarını listeleyeceğiz -->
    </div>
    
    <script>
        // Verilere göre kartı oluşturan fonksiyon
        function createProductCard(data, productCount) {
            const card = document.createElement('div');
            card.classList.add('product-card');

            // Kartın içeriği
            const productName = document.createElement('h2');
            productName.textContent = data.title; // API'den dönen veriye göre ürün adını güncelleyin

            const productDescription = document.createElement('p');
            productDescription.textContent = data.description; // API'den dönen veriye göre ürün açıklamasını güncelleyin

            const productPrice = document.createElement('p');
            productPrice.textContent = 'Price: ' + data.price + ' TL'; // API'den dönen veriye göre ürün fiyatını güncelleyin
            
            // Kartın içeriğini kart elementine ekleyin
            card.appendChild(productName);
            card.appendChild(productDescription);
            card.appendChild(productPrice);

            // Ürün resmini ekleyin
            const productImage = document.createElement('img');
            productImage.src = data.image; // API'den dönen veriye göre ürün resminin URL'sini güncelleyin
            productImage.alt = data.title; // Ürün adını alternatif metin olarak ekleyebilirsiniz

            // Kartın içeriğine ürün resmini ekleyin
            card.appendChild(productImage);

            // Ürün adedini ekleyin
            const productCountElement = document.createElement('p');
            productCountElement.textContent = 'Adet: ' + productCount;
            card.appendChild(productCountElement);

            return card;
        }

        window.onload = function() {
            const apiUrl = '/api/products/'; // API adresini burada değiştirin
            const productList = document.getElementById('productList');
            const savedProducts = JSON.parse(localStorage.getItem('cartItems')) || [];

            if (savedProducts && savedProducts.length > 0) {
                const uniqueProducts = Array.from(new Set(savedProducts));
                uniqueProducts.forEach(product => {
                    const productCount = savedProducts.filter(item => item === product).length;

                    // API'ye GET isteği atalım
                    fetch(`${apiUrl}${product}/`, {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('API isteği başarısız oldu.');
                        }
                        return response.json();
                    })
                    .then(data => {
                        const card = createProductCard(data, productCount); // Verilere göre kartı oluşturalım
                        productList.appendChild(card);
                    })
                    .catch(error => {
                        console.error('API isteği sırasında bir hata oluştu:', error);
                    });
                });
            } else {
                const li = document.createElement('li');
                li.textContent = 'Henüz ürün yok.';
                productList.appendChild(li);
            }
        };
    </script>
</body>
</html>
